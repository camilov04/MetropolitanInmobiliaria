{% extends "base_admin.html" %}
{% block content %}
<nav class="admin-breadcrumbs">
    <a href="{{ url_for('panel_admin') }}">ğŸ  Panel</a>

    {% if request.endpoint == 'admin_inmuebles' %}
        <span>â€º</span>
        <span>Inmuebles</span>
    {% elif request.endpoint == 'nuevo_inmueble' %}
        <span>â€º</span>
        <a href="{{ url_for('admin_inmuebles') }}">Inmuebles</a>
        <span>â€º</span>
        <span>Nuevo</span>
    {% elif request.endpoint == 'editar_inmueble' %}
        <span>â€º</span>
        <a href="{{ url_for('admin_inmuebles') }}">Inmuebles</a>
        <span>â€º</span>
        <span>Editar</span>
    {% endif %}
</nav>


<h2>ğŸ“‹ Inmuebles registrados</h2>

<a href="{{ url_for('panel_admin') }}" class="btn-secondary">
    â† Volver al panel
</a>
<div class="admin-filters">

    <a href="{{ url_for('admin_inmuebles') }}"
       class="filter-btn {% if not solo_destacados %}active{% endif %}">
        Todos
    </a>

    <a href="{{ url_for('admin_inmuebles', destacados=1) }}"
       class="filter-btn {% if solo_destacados %}active{% endif %}">
        â­ Destacados
    </a>

</div>

<div class="admin-list">

    {% for i in inmuebles %}
    <div class="admin-item">

        <div class="admin-thumb">
            {% if i.imagen_url %}
                <img src="{{ i.imagen_url }}" alt="img">
            {% else %}
                â€”
            {% endif %}
        </div>

        <div class="admin-info">
            <h4>
                {{ i.titulo }}

                {% if i.destacado %}
                    <span class="star-badge">â­</span>
                {% endif %}
            </h4>
            <p class="muted">
                {{ i.tipo_negocio }} Â· {{ i.tipo }} Â· ${{ "{:,.0f}".format(i.precio) }}
            </p>
        </div>


        <div class="admin-actions">
            <a href="{{ url_for('editar_inmueble', id=i.id) }}" class="btn-edit">âœï¸</a>

            <form method="POST"
                  action="{{ url_for('eliminar_inmueble', id=i.id) }}"
                  onsubmit="return confirm('Â¿Eliminar inmueble?');">
                <button class="btn-delete">ğŸ—‘ï¸</button>
            </form>
        <div class="plan-box">

    {% if i.plan_activo %}

        <span class="plan-badge plan-{{ i.plan|lower }}">
            {{ i.plan }}
        </span>

        <p class="plan-date">
            Vence: {{ i.plan_vencimiento.strftime("%d/%m/%Y") }}
        </p>

        <form method="POST" action="{{ url_for('desactivar_plan', id=i.id) }}">
            <button class="btn-delete">Desactivar</button>
        </form>

    {% else %}

        <span class="plan-badge plan-none">
            Sin plan
        </span>

        <form method="POST" action="{{ url_for('activar_plan', id=i.id) }}">

            <select name="plan" required>
                <option value="">Seleccionar plan</option>
                <option value="Basico">BÃ¡sico</option>
                <option value="Premium">Premium</option>
                <option value="Destacado">Destacado</option>
            </select>

            <button class="btn-primary">Activar</button>

        </form>

    {% endif %}

</div>





        </div>

    </div>
    {% endfor %}

</div>


{% endblock %}

